<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulación Monte Carlo de Procesos de Deposición en Películas Delgadas</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --background-color: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2rem;
            font-weight: 300;
        }
        
        .section {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        h3 {
            color: var(--secondary-color);
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .objectives {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .objective-card {
            flex: 1;
            min-width: 300px;
            background: var(--light-color);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary-color);
        }
        
        .objective-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .method-description {
            background: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary-color);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-top: 3px solid var(--secondary-color);
        }
        
        .result-card h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .comparison-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .comparison-table .highlight {
            background-color: #e8f4fc;
            font-weight: 600;
        }
        
        .image-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .image-card {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .image-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }
        
        .image-card .caption {
            padding: 15px;
            background: white;
        }
        
        .image-card .caption h4 {
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .conclusion {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid var(--success-color);
        }
        
        .conclusion h3 {
            color: var(--success-color);
        }
        
        .conclusion ul {
            padding-left: 20px;
            margin-top: 15px;
        }
        
        .conclusion li {
            margin-bottom: 10px;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 5px;
        }
        
        .badge-thermal {
            background-color: #3498db;
            color: white;
        }
        
        .badge-ballistic {
            background-color: #e74c3c;
            color: white;
        }
        
        .badge-increase {
            background-color: #27ae60;
            color: white;
        }
        
        .badge-decrease {
            background-color: #f39c12;
            color: white;
        }
        
        .badge-success {
            background-color: #27ae60;
            color: white;
        }
        
        .download-btn {
            display: block;
            width: 300px;
            margin: 30px auto;
            padding: 15px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s;
        }
        
        .download-btn:hover {
            background-color: #219653;
        }
        
        .download-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        .download-btn i {
            margin-right: 10px;
        }
        
        footer {
            background: var(--primary-color);
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .image-container {
                flex-direction: column;
            }
            
            .comparison-table {
                font-size: 0.9rem;
            }
            
            .comparison-table th, .comparison-table td {
                padding: 8px 10px;
            }
        }
        
        /* Estilos para mensajes de estado */
        .status-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .status-message.success {
            background-color: var(--success-color);
        }
        
        .status-message.error {
            background-color: var(--accent-color);
        }
        
        .status-message.info {
            background-color: var(--secondary-color);
        }
        
        .status-message.warning {
            background-color: var(--warning-color);
        }
        
        /* Estilos para el indicador de carga */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .loading-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 400px;
        }
        
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--success-color);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Simulación Monte Carlo de Procesos de Deposición en Películas Delgadas</h1>
            <p>Análisis comparativo de modos de deposición térmico y balístico para Cr y Fe sobre Mg (001)</p>
        </div>
    </header>

    <div class="container">
        <section class="section">
            <h2>Objetivos del Trabajo</h2>
            <div class="objectives">
                <div class="objective-card">
                    <h4>Objetivo General</h4>
                    <p>Simular el proceso de deposición de películas delgadas de Cr y Fe mediante el método de Monte Carlo.</p>
                </div>
                <div class="objective-card">
                    <h4>Objetivos Específicos</h4>
                    <ol>
                        <li>Caracterizar los mecanismos de deposición en películas delgadas de Cr y Fe sobre Mg (001) mediante KMC.</li>
                        <li>Determinar los efectos de la difusión superficial en el proceso de deposición.</li>
                        <li>Delimitar el efecto del modo de deposición en las propiedades físicas de las películas.</li>
                    </ol>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Descripción del Método KMC</h2>
            <div class="method-description">
                <p>El programa <code>simulation_kmc_unificado</code> implementa una simulación Monte Carlo Cinético tridimensional que modela:</p>
                <ul>
                    <li>La deposición de átomos (Cr o Fe) sobre un sustrato de Mg (001)</li>
                    <li>La difusión superficial de átomos depositados</li>
                    <li>Tres modos de deposición: Térmico, Balístico y Aleatorio</li>
                </ul>
                <p><strong>Parámetros clave:</strong></p>
                <ul>
                    <li>Rejilla tridimensional: 50×50×30 sitios</li>
                    <li>Temperatura del sustrato: 500K</li>
                    <li>Temperatura del plasma: 1000K</li>
                    <li>Constante de Boltzmann: 8.617×10⁻⁵ eV/K</li>
                </ul>
                <p><strong>Propiedades de materiales:</strong></p>
                <ul>
                    <li><strong>Cromo (Cr):</strong> Mayor adhesión (0.98), menor energía de difusión (0.01-0.25 eV)</li>
                    <li><strong>Hierro (Fe):</strong> Menor adhesión (0.95), mayor energía de difusión (0.5-1.0 eV)</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>Análisis del Modo Térmico</h2>
            <h3>Resultados Numéricos</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>Resultados para Fe</h4>
                    <ul>
                        <li>Rugosidad: 6.83 ± 2.54 capas</li>
                        <li>Espesor: 9.32 ± 5.29 capas</li>
                        <li>Altura máxima: 24.45 ± 6.69 capas</li>
                        <li>Cobertura (>10 capas): 40.96%</li>
                        <li>Cobertura (>20 capas): 15.40%</li>
                        <li>Distribución de etapas: 33.33% coalescencia, 66.67% crecimiento</li>
                    </ul>
                </div>
                <div class="result-card">
                    <h4>Resultados para Cr</h4>
                    <ul>
                        <li>Rugosidad: 6.83 ± 2.56 capas</li>
                        <li>Espesor: 9.22 ± 5.25 capas</li>
                        <li>Altura máxima: 24.52 ± 6.83 capas</li>
                        <li>Cobertura (>10 capas): 40.28%</li>
                        <li>Cobertura (>20 capas): 15.13%</li>
                        <li>Distribución de etapas: 33.33% coalescencia, 66.67% crecimiento</li>
                    </ul>
                </div>
            </div>
            
            <h3>Conclusiones del Modo Térmico</h3>
            <ul>
                <li>Homogeneidad entre materiales: Las altas temperaturas (500K) igualan las diferencias intrínsecas entre Fe y Cr</li>
                <li>Crecimiento limitado: Ningún material supera 30 capas de altura, indicando saturación</li>
                <li>Etapa avanzada: Ausencia de nucleación (0%) y predominio de crecimiento (66.67%) sugieren películas maduras</li>
                <li>Cr forma islas más compactas inicialmente, pero ambos materiales convergen en espesor final</li>
            </ul>
            
            <h3>Visualización de Resultados</h3>
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/37768e0e-a19f-423a-9488-abec87a46d71_comparacion_espesor.png?auth_key=1792296018-0cf586bda3f44e74b6de4e37f4cb7179-0-445535939cc453c89e9ec3d5bb44c81d" alt="Comparación de Espesor" data-caption="Comparación de Espesor: Fe vs Cr" data-description="En modo térmico, ambos materiales muestran distribuciones de espesor muy similares">
                    <div class="caption">
                        <h4>Comparación de Espesor: Fe vs Cr</h4>
                        <p>En modo térmico, ambos materiales muestran distribuciones de espesor muy similares</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/52f1945b-fa96-43d5-a25b-bc4de9f95dbb_comparacion_rugosidad.png?auth_key=1792296018-0a1129086b1649a1a43d074b814e2494-0-a7e52fa70db96e100615e3472bc5371d" alt="Comparación de Rugosidad" data-caption="Comparación de Rugosidad: Fe vs Cr" data-description="Cr presenta un pico más definido en 9-10 capas, mientras Fe muestra una distribución más amplia">
                    <div class="caption">
                        <h4>Comparación de Rugosidad: Fe vs Cr</h4>
                        <p>Cr presenta un pico más definido en 9-10 capas, mientras Fe muestra una distribución más amplia</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/fb5a51fc-8322-4c70-9b25-fd9d0ff5eb3a_mapa_3d_promedio_Cr.png?auth_key=1792296018-bb6028d0ef494e9e93f7db429189ef6e-0-cfe0436f3ee2584386f8c6e5908f9c69" alt="Mapa 3D Cr" data-caption="Mapa 3D Promedio - Cr" data-description="Topografía con picos agudos y valles profundos, transiciones abruptas entre alto/bajo">
                    <div class="caption">
                        <h4>Mapa 3D Promedio - Cr</h4>
                        <p>Topografía con picos agudos y valles profundos, transiciones abruptas entre alto/bajo</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/b33c5557-8e94-40b8-ad12-231c3bea50b8_mapa_3d_promedio_Fe.png?auth_key=1792296018-4276aa34b33543fcae1d680fa432b0ef-0-21a8365545cc0c46320a6d6e4165c786" alt="Mapa 3D Fe" data-caption="Mapa 3D Promedio - Fe" data-description="Superficie más suave y continua, transiciones graduales de altura">
                    <div class="caption">
                        <h4>Mapa 3D Promedio - Fe</h4>
                        <p>Superficie más suave y continua, transiciones graduales de altura</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://anchacin3620.github.io/cr.png?auth_key=1792296018-8f638a38cec4625bf555602c0f5a3f0-0-587ac6902fa8cece735372eb8866c0e8" alt="Mapa Contorno Cr" data-caption="Mapa de Contorno - Cr" data-description="Parches bien definidos de alta altura, bordes nítidos entre regiones">
                    <div class="caption">
                        <h4>Mapa de Contorno - Cr</h4>
                        <p>Parches bien definidos de alta altura, bordes nítidos entre regiones</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/dc63b278-6c52-46b6-a985-e50d241c5ce6_mapa_contorno_Fe.png?auth_key=1792296018-f10b5cb3010f4224b7a8e5301c217a18-0-8538793c8912742915ca427692e99c7c" alt="Mapa Contorno Fe" data-caption="Mapa de Contorno - Fe" data-description="Gradientes suaves de altura, transiciones difusas entre regiones">
                    <div class="caption">
                        <h4>Mapa de Contorno - Fe</h4>
                        <p>Gradientes suaves de altura, transiciones difusas entre regiones</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/b86d529b-6028-4b19-8290-4d5cbdf008df_rugosidad_vs_energia.png?auth_key=1792296018-95def81d04824bcbba5b1386f276dc0e-0-09d8e6f1763304b8db671bf7e5973428" alt="Rugosidad vs Energía" data-caption="Rugosidad vs Energía de Difusión" data-description="En modo térmico, la temperatura alta (500K) mitiga diferencias energéticas entre materiales">
                    <div class="caption">
                        <h4>Rugosidad vs Energía de Difusión</h4>
                        <p>En modo térmico, la temperatura alta (500K) mitiga diferencias energéticas entre materiales</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Análisis del Modo Balístico</h2>
            <h3>Resultados Numéricos</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>Resultados para Fe</h4>
                    <ul>
                        <li>Rugosidad: 7.28 ± 2.62 capas</li>
                        <li>Espesor: 10.52 ± 5.63 capas</li>
                        <li>Altura máxima: 27.83 ± 7.01 capas</li>
                        <li>Cobertura (>10 capas): 46.35%</li>
                        <li>Cobertura (>20 capas): 20.83%</li>
                        <li>Cobertura (>30 capas): 2.50%</li>
                        <li>Distribución de etapas: 30.00% coalescencia, 70.00% crecimiento</li>
                    </ul>
                </div>
                <div class="result-card">
                    <h4>Resultados para Cr</h4>
                    <ul>
                        <li>Rugosidad: 7.53 ± 2.68 capas</li>
                        <li>Espesor: 10.81 ± 5.71 capas</li>
                        <li>Altura máxima: 28.22 ± 7.12 capas</li>
                        <li>Cobertura (>10 capas): 47.92%</li>
                        <li>Cobertura (>20 capas): 21.67%</li>
                        <li>Cobertura (>30 capas): 3.33%</li>
                        <li>Distribución de etapas: 30.00% coalescencia, 70.00% crecimiento</li>
                    </ul>
                </div>
            </div>
            
            <h3>Visualización de Resultados - Modo Balístico</h3>
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/de27b97c-c4bb-4c46-92b3-eb5479a5e984_rugosidad_vs_energia%20%281%29.png?auth_key=1792342409-f2dc313ad18d4e619eb8a0d38aa5568b-0-c7f9e00226f1b30bcafff73633282fef" alt="Rugosidad vs Energía" data-caption="Rugosidad vs Energía de Difusión - Modo Balístico" data-description="En modo balístico, Cr mantiene concentración en baja energía (0-0.25 eV) con rugosidad 4-9 capas, mientras Fe se distribuye en mayor energía (0.5-0.9 eV) con rugosidad 3-9 capas, mostrando mayor dispersión vertical.">
                    <div class="caption">
                        <h4>Rugosidad vs Energía de Difusión - Modo Balístico</h4>
                        <p>En modo balístico, Cr mantiene concentración en baja energía (0-0.25 eV) con rugosidad 4-9 capas, mientras Fe se distribuye en mayor energía (0.5-0.9 eV) con rugosidad 3-9 capas, mostrando mayor dispersión vertical.</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/6b013e72-b4fb-4f02-93bc-be59f91cb27d_comparacion_rugosidad%20%281%29.png?auth_key=1792342409-cafd728d400043dfa4e586f28e517d33-0-eeefc3de7b58b4b194396ad504dd3b47" alt="Comparación de Rugosidad" data-caption="Comparación de Rugosidad: Fe vs Cr - Modo Balístico" data-description="Fe muestra distribución más amplia y desplazada hacia mayores rugosidades (pico en 9-10 capas), mientras Cr mantiene doble pico (5 y 9-10 capas), confirmando mayor heterogeneidad superficial en modo balístico.">
                    <div class="caption">
                        <h4>Comparación de Rugosidad: Fe vs Cr - Modo Balístico</h4>
                        <p>Fe muestra distribución más amplia y desplazada hacia mayores rugosidades (pico en 9-10 capas), mientras Cr mantiene doble pico (5 y 9-10 capas), confirmando mayor heterogeneidad superficial en modo balístico.</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/47b9fc42-d0bb-4034-a843-d600fc6ed3ac_comparacion_espesor%20%281%29.png?auth_key=1792342409-d13dfaaca8a34f23a558b85564032e6-0-2340b1d9d23ed98891394f517de70b03" alt="Comparación de Espesor" data-caption="Comparación de Espesor: Fe vs Cr - Modo Balístico" data-description="En modo balístico, Cr alcanza mayor espesor promedio en el rango 15-16 capas, mientras Fe muestra distribución más simétrica alrededor de 10 capas, confirmando datos numéricos de +17.3% para Cr vs +12.9% para Fe.">
                    <div class="caption">
                        <h4>Comparación de Espesor: Fe vs Cr - Modo Balístico</h4>
                        <p>En modo balístico, Cr alcanza mayor espesor promedio en el rango 15-16 capas, mientras Fe muestra distribución más simétrica alrededor de 10 capas, confirmando datos numéricos de +17.3% para Cr vs +12.9% para Fe.</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/b229bc1c-27c2-4a4b-a59b-8841636855d9_histograma_promedio%20%281%29.png?auth_key=1792342409-602c8dc6a4674802aa0ea94d279311cb-0-7eae45a4cd274daa6fb0bec6f31277eb" alt="Histograma de Alturas" data-caption="Distribución de Alturas Promedio - Modo Balístico" data-description="El histograma (media 9.28 capas, desviación 8.99) confirma amplia dispersión en alturas, con alta probabilidad en bajas alturas y cola extendida hacia valores >30 capas, característico del crecimiento vertical en modo balístico.">
                    <div class="caption">
                        <h4>Distribución de Alturas Promedio - Modo Balístico</h4>
                        <p>El histograma (media 9.28 capas, desviación 8.99) confirma amplia dispersión en alturas, con alta probabilidad en bajas alturas y cola extendida hacia valores >30 capas, característico del crecimiento vertical en modo balístico.</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/f320f871-cdbc-4db4-bcb2-425659942e6d_mapa_3d_promedio_Fe%20%281%29.png?auth_key=1792342409-e635430bcc2f4e82bbe83e0d623f1075-0-23202add20c4f6fe359852ebdc6d008d" alt="Mapa 3D Fe" data-caption="Mapa 3D Promedio - Fe - Modo Balístico" data-description="Fe muestra topografía con picos pronunciados (hasta 14 capas) y valles profundos, con transiciones abruptas entre altas y bajas, confirmando mayor rugosidad (+6.6%) respecto al modo térmico.">
                    <div class="caption">
                        <h4>Mapa 3D Promedio - Fe - Modo Balístico</h4>
                        <p>Fe muestra topografía con picos pronunciados (hasta 14 capas) y valles profundos, con transiciones abruptas entre altas y bajas, confirmando mayor rugosidad (+6.6%) respecto al modo térmico.</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/80349f5e-a65d-4875-8c07-516379b44f2c_mapa_3d_promedio_Cr%20%281%29.png?auth_key=1792342409-efbe3d632c144defb8da5ed13d0232ea-0-dc011643b8d2e58229eed11d41e23262" alt="Mapa 3D Cr" data-caption="Mapa 3D Promedio - Cr - Modo Balístico" data-description="Cr presenta superficie con islas más altas y definidas (hasta 12 capas), con transiciones más abruptas que Fe, explicando su mayor rugosidad (+10.3%) y cobertura en capas altas (>30 capas: 3.33% vs 2.50% Fe).">
                    <div class="caption">
                        <h4>Mapa 3D Promedio - Cr - Modo Balístico</h4>
                        <p>Cr presenta superficie con islas más altas y definidas (hasta 12 capas), con transiciones más abruptas que Fe, explicando su mayor rugosidad (+10.3%) y cobertura en capas altas (>30 capas: 3.33% vs 2.50% Fe).</p>
                    </div>
                </div>
            </div>
            
            <div class="image-container">
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/52836eee-c8c2-49e6-8ad0-d0a82a980fcd_mapa_contorno_Fe%20%281%29.png?auth_key=1792342409-73622ddb323c4123a02d058a3580264a-0-5beba0ae742a512c09ea1b624c1d8d7e" alt="Mapa Contorno Fe" data-caption="Mapa de Contorno - Fe - Modo Balístico" data-description="Regiones de alta altura (amarillo, 14.4 capas) más concentradas y definidas, con bordes nítidos que confirman formación de columnas verticales características del modo balístico.">
                    <div class="caption">
                        <h4>Mapa de Contorno - Fe - Modo Balístico</h4>
                        <p>Regiones de alta altura (amarillo, 14.4 capas) más concentradas y definidas, con bordes nítidos que confirman formación de columnas verticales características del modo balístico.</p>
                    </div>
                </div>
                <div class="image-card">
                    <img src="https://z-cdn-media.chatglm.cn/files/75a0cf73-f4bc-49a9-a3ec-0038b926708f_mapa_contorno_Cr%20%281%29.png?auth_key=1792342409-f74b25d6fec94d09a55ed63f5599c99e-0-22f8c9dfbd98e51cea4b658320dbbade" alt="Mapa Contorno Cr" data-caption="Mapa de Contorno - Cr - Modo Balístico" data-description="Distribución de altura más heterogénea, con parches de alta altura (amarillo) más aislados y bordes muy definidos, explicando mayor cobertura en capas altas (+43.2% en >20 capas vs +35.3% Fe).">
                    <div class="caption">
                        <h4>Mapa de Contorno - Cr - Modo Balístico</h4>
                        <p>Distribución de altura más heterogénea, con parches de alta altura (amarillo) más aislados y bordes muy definidos, explicando mayor cobertura en capas altas (+43.2% en >20 capas vs +35.3% Fe).</p>
                    </div>
                </div>
            </div>
            
            <h3>Conclusiones del Modo Balístico</h3>
            <ul>
                <li><strong>Mayor crecimiento vertical:</strong> Ambos materiales alcanzan alturas superiores a 30 capas (imposible en modo térmico), confirmado por histograma con cola extendida y mapas 3D.</li>
                <li><strong>Mayor cobertura:</strong> Incremento significativo en áreas con >10 y >20 capas, especialmente en Cr (+43.2% vs +35.3% Fe), visible en mapas de contorno.</li>
                <li><strong>Mayor rugosidad:</strong> Cr muestra mayor incremento relativo (+10.3% vs +6.6% Fe), evidenciado por picos más pronunciados en mapas 3D y distribución de rugosidad más amplia.</li>
                <li><strong>Formación de nanoestructuras:</strong> Mapas de contorno revelan islas bien definidas con bordes nítidos, característicos del crecimiento balístico.</li>
                <li><strong>Respuesta material diferencial:</strong> Cr aprovecha mejor el modo balístico para alcanzar mayores espesores y coberturas, debido a su menor energía de difusión intrínseca.</li>
            </ul>
        </section>

        <section class="section">
            <h2>Comparación entre Modos de Deposición</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Modo Térmico</th>
                        <th>Modo Balístico</th>
                        <th>Cambio (%)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Fe - Rugosidad</strong></td>
                        <td>6.83 ± 2.54</td>
                        <td class="highlight">7.28 ± 2.62</td>
                        <td><span class="badge badge-increase">+6.6%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Rugosidad</strong></td>
                        <td>6.83 ± 2.56</td>
                        <td class="highlight">7.53 ± 2.68</td>
                        <td><span class="badge badge-increase">+10.3%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Espesor</strong></td>
                        <td>9.32 ± 5.29</td>
                        <td class="highlight">10.52 ± 5.63</td>
                        <td><span class="badge badge-increase">+12.9%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Espesor</strong></td>
                        <td>9.22 ± 5.25</td>
                        <td class="highlight">10.81 ± 5.71</td>
                        <td><span class="badge badge-increase">+17.3%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Altura Máxima</strong></td>
                        <td>24.45 ± 6.69</td>
                        <td class="highlight">27.83 ± 7.01</td>
                        <td><span class="badge badge-increase">+13.8%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Altura Máxima</strong></td>
                        <td>24.52 ± 6.83</td>
                        <td class="highlight">28.22 ± 7.12</td>
                        <td><span class="badge badge-increase">+15.0%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Cobertura (>10 capas)</strong></td>
                        <td>40.96%</td>
                        <td class="highlight">46.35%</td>
                        <td><span class="badge badge-increase">+13.2%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Cobertura (>10 capas)</strong></td>
                        <td>40.28%</td>
                        <td class="highlight">47.92%</td>
                        <td><span class="badge badge-increase">+19.0%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Cobertura (>20 capas)</strong></td>
                        <td>15.40%</td>
                        <td class="highlight">20.83%</td>
                        <td><span class="badge badge-increase">+35.3%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Cobertura (>20 capas)</strong></td>
                        <td>15.13%</td>
                        <td class="highlight">21.67%</td>
                        <td><span class="badge badge-increase">+43.2%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Cobertura (>30 capas)</strong></td>
                        <td>0.00%</td>
                        <td class="highlight">2.50%</td>
                        <td><span class="badge badge-increase">+∞</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Cobertura (>30 capas)</strong></td>
                        <td>0.00%</td>
                        <td class="highlight">3.33%</td>
                        <td><span class="badge badge-increase">+∞</span></td>
                    </tr>
                    <tr>
                        <td><strong>Fe - Etapa Crecimiento</strong></td>
                        <td>66.67%</td>
                        <td class="highlight">70.00%</td>
                        <td><span class="badge badge-increase">+3.33%</span></td>
                    </tr>
                    <tr>
                        <td><strong>Cr - Etapa Crecimiento</strong></td>
                        <td>66.67%</td>
                        <td class="highlight">70.00%</td>
                        <td><span class="badge badge-increase">+3.33%</span></td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Interpretación Física</h3>
            <ul>
                <li><strong>Energía cinética más alta:</strong> El modo balístico (5.0 eV vs. 2.0 eV térmico) permite a los átomos penetrar más profundamente en la superficie</li>
                <li><strong>Menor movilidad superficial:</strong> Menor tiempo para difusión antes de quedar "atrapados", favoreciendo el crecimiento vertical</li>
                <li><strong>Menor tasa de deposición:</strong> 20,000 (vs. 50,000 térmico) permite a los átomos apilarse más verticalmente</li>
                <li><strong>Respuesta diferencial de materiales:</strong> Cr muestra mayores incrementos que Fe debido a su menor energía de difusión intrínseca</li>
            </ul>
        </section>

        <section class="section conclusion">
            <h2>Conclusiones Finales</h2>
            <h3>Relación con Objetivos del Trabajo</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Objetivo Específico</th>
                        <th>Evidencia</th>
                        <th>Cumplimiento</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Caracterizar mecanismos de deposición</td>
                        <td>Mayor crecimiento vertical en balístico (70% vs. 66.67% térmico)</td>
                        <td><span class="badge badge-success">Completado</span></td>
                    </tr>
                    <tr>
                        <td>Efectos de difusión superficial</td>
                        <td>Mayor rugosidad en Cr (+10.3% vs. +6.6% Fe) confirma menor movilidad</td>
                        <td><span class="badge badge-success">Completado</span></td>
                    </tr>
                    <tr>
                        <td>Efecto del modo de deposición</td>
                        <td>Diferencias significativas: +12-17% espesor, +6-10% rugosidad</td>
                        <td><span class="badge badge-success">Completado</span></td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Conclusiones Principales</h3>
            <ul>
                <li><strong>Modo Térmico:</strong> Produce películas más uniformes y continuas, con menor rugosidad y crecimiento vertical limitado. Ideal para aplicaciones que requieren homogeneidad superficial.</li>
                <li><strong>Modo Balístico:</strong> Genera películas más gruesas con mayor cobertura, pero con mayor rugosidad. Permite alcanzar alturas >30 capas, imposible en modo térmico. Adecuado para aplicaciones que requieren mayor espesor.</li>
                <li><strong>Diferencias materiales:</strong> Cr responde más intensamente al cambio de modo que Fe, debido a su menor energía de difusión intrínseca.</li>
                <li><strong>Implicaciones prácticas:</strong> 
                    <ul>
                        <li>Para aplicaciones que requieren continuidad: Fe en modo térmico es preferible</li>
                        <li>Para aplicaciones que requieren nanoestructuras definidas: Cr en modo balístico es mejor</li>
                        <li>Para mayor espesor: Modo balístico es superior</li>
                    </ul>
                </li>
            </ul>
        </section>
        
        <button id="download-btn" class="download-btn">
            <i class="fas fa-file-word"></i> Descargar Informe en Word
        </button>
    </div>

    <footer>
        <div class="container">
            <p>Elaborado por Ángel Chacín Ávila @2025 se publica con licencia GPL</p>
        </div>
    </footer>

    <!-- Mensaje de estado -->
    <div id="status-message" class="status-message"></div>
    
    <!-- Indicador de carga -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loading-text">Preparando documento...</p>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <p id="progress-text">0%</p>
        </div>
    </div>

    <script>
        // Función para mostrar mensajes de estado
        function showStatus(message, type) {
            const statusElement = document.getElementById('status-message');
            statusElement.textContent = message;
            statusElement.className = `status-message ${type}`;
            statusElement.style.display = 'block';
            
            // Ocultar el mensaje después de 5 segundos
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 5000);
        }
        
        // Función para mostrar/ocultar el indicador de carga
        function toggleLoading(show, text = '', progress = 0) {
            const loadingOverlay = document.getElementById('loading-overlay');
            const loadingText = document.getElementById('loading-text');
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            
            if (show) {
                if (text) loadingText.textContent = text;
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `${progress}%`;
                loadingOverlay.style.display = 'flex';
            } else {
                loadingOverlay.style.display = 'none';
            }
        }
        
        // Función para convertir imagen a base64 con manejo de errores mejorado
        function imageToBase64(img) {
            return new Promise((resolve, reject) => {
                // Crear un canvas para procesar la imagen
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Esperar a que la imagen esté completamente cargada
                if (img.complete) {
                    processImage();
                } else {
                    img.onload = processImage;
                    img.onerror = () => reject(new Error('Error al cargar la imagen'));
                }
                
                function processImage() {
                    try {
                        // Establecer dimensiones del canvas
                        canvas.width = img.naturalWidth || img.width;
                        canvas.height = img.naturalHeight || img.height;
                        
                        // Dibujar la imagen en el canvas
                        ctx.drawImage(img, 0, 0);
                        
                        // Convertir a base64 con formato compatible con Word
                        const base64 = canvas.toDataURL('image/png', 0.9);
                        resolve(base64);
                    } catch (error) {
                        reject(error);
                    }
                }
            });
        }
        
        // Función para descargar todas las imágenes con manejo de errores
        async function downloadAllImages() {
            const images = document.querySelectorAll('img[data-caption]');
            const imageData = [];
            
            for (let i = 0; i < images.length; i++) {
                const img = images[i];
                const caption = img.getAttribute('data-caption');
                const description = img.getAttribute('data-description');
                
                try {
                    // Asegurarse de que la imagen esté completamente cargada
                    if (!img.complete) {
                        await new Promise((resolve, reject) => {
                            img.onload = resolve;
                            img.onerror = reject;
                            // Forzar la carga si está en caché
                            if (img.complete) resolve();
                        });
                    }
                    
                    // Convertir la imagen a base64
                    const base64 = await imageToBase64(img);
                    
                    imageData.push({
                        src: base64,
                        caption: caption,
                        description: description
                    });
                    
                    // Actualizar progreso
                    const progress = Math.round(((i + 1) / images.length) * 50);
                    toggleLoading(true, `Procesando imagen ${i + 1} de ${images.length}...`, progress);
                    
                    // Pequeña pausa para no sobrecargar el navegador
                    await new Promise(resolve => setTimeout(resolve, 100));
                } catch (error) {
                    console.error(`Error al procesar imagen ${i}:`, error);
                    // Continuar con la siguiente imagen
                }
            }
            
            return imageData;
        }
        
        // Función para generar el documento Word con imágenes incrustadas
        async function generateWordDocument() {
            const downloadBtn = document.getElementById('download-btn');
            const originalText = downloadBtn.innerHTML;
            
            // Deshabilitar el botón y mostrar indicador de carga
            downloadBtn.disabled = true;
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generando documento...';
            toggleLoading(true, 'Iniciando generación del documento...', 0);
            
            try {
                showStatus('Iniciando generación del documento Word...', 'info');
                
                // Descargar todas las imágenes
                const imageData = await downloadAllImages();
                
                toggleLoading(true, 'Generando estructura del documento...', 60);
                
                // Crear el contenido HTML para el documento Word con imágenes incrustadas
                const htmlContent = `
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word">
<meta name=Originator content="Microsoft Word">
<!--[if gte mso 9]>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>90</w:Zoom>
<w:DoNotOptimizeForBrowser/>
</w:WordDocument>
</xml>
<![endif]-->
<style>
@page {
    size: A4;
    margin: 2.54cm;
}
@page Section1 {
    mso-header-margin: 2.54cm;
    mso-footer-margin: 2.54cm;
    mso-paper-source: 0;
}
div.Section1 {
    page: Section1;
}
h1 {
    font-family: Arial, sans-serif;
    font-size: 18pt;
    font-weight: bold;
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
}
h2 {
    font-family: Arial, sans-serif;
    font-size: 14pt;
    font-weight: bold;
    color: #2c3e50;
    margin-top: 20px;
    margin-bottom: 10px;
    border-bottom: 1px solid #3498db;
    padding-bottom: 5px;
}
h3 {
    font-family: Arial, sans-serif;
    font-size: 12pt;
    font-weight: bold;
    color: #3498db;
    margin-top: 15px;
    margin-bottom: 8px;
}
p {
    font-family: Arial, sans-serif;
    font-size: 11pt;
    line-height: 1.4;
    margin-bottom: 8px;
}
ul, ol {
    font-family: Arial, sans-serif;
    font-size: 11pt;
    line-height: 1.4;
    margin-bottom: 10px;
}
li {
    margin-bottom: 5px;
}
table {
    border-collapse: collapse;
    width: 100%;
    margin: 15px 0;
}
th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    font-family: Arial, sans-serif;
    font-size: 10pt;
}
th {
    background-color: #2c3e50;
    color: white;
    font-weight: bold;
}
tr:nth-child(even) {
    background-color: #f2f2f2;
}
.highlight {
    background-color: #e8f4fc;
    font-weight: bold;
}
.image-container {
    margin: 15px 0;
    text-align: center;
    page-break-inside: avoid;
}
.image-container img {
    max-width: 100%;
    height: auto;
    margin: 10px 0;
    display: block;
}
.image-caption {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    font-style: italic;
    margin-top: 5px;
    color: #555;
}
.method-description {
    background: #e8f4fc;
    padding: 15px;
    border-radius: 5px;
    border-left: 4px solid #3498db;
    margin: 15px 0;
}
.conclusion {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    padding: 15px;
    border-radius: 5px;
    border-left: 4px solid #27ae60;
    margin: 15px 0;
}
.result-card {
    background: white;
    border-radius: 5px;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border-top: 3px solid #3498db;
    margin: 10px 0;
}
.badge {
    display: inline-block;
    padding: 3px 6px;
    border-radius: 3px;
    font-size: 9pt;
    font-weight: bold;
    margin-right: 5px;
}
.badge-increase {
    background-color: #27ae60;
    color: white;
}
.badge-success {
    background-color: #27ae60;
    color: white;
}
</style>
</head>
<body>
<div class="Section1">
    <h1>Simulación Monte Carlo de Procesos de Deposición en Películas Delgadas</h1>
    <p style="text-align: center; font-size: 12pt; margin-bottom: 30px;">Análisis comparativo de modos de deposición térmico y balístico para Cr y Fe sobre Mg (001)</p>
    
    <h2>Objetivos del Trabajo</h2>
    <div class="result-card">
        <h3>Objetivo General</h3>
        <p>Simular el proceso de deposición de películas delgadas de Cr y Fe mediante el método de Monte Carlo.</p>
    </div>
    
    <div class="result-card">
        <h3>Objetivos Específicos</h3>
        <ol>
            <li>Caracterizar los mecanismos de deposición en películas delgadas de Cr y Fe sobre Mg (001) mediante KMC.</li>
            <li>Determinar los efectos de la difusión superficial en el proceso de deposición.</li>
            <li>Delimitar el efecto del modo de deposición en las propiedades físicas de las películas.</li>
        </ol>
    </div>
    
    <h2>Descripción del Método KMC</h2>
    <div class="method-description">
        <p>El programa <code>simulation_kmc_unificado</code> implementa una simulación Monte Carlo Cinético tridimensional que modela:</p>
        <ul>
            <li>La deposición de átomos (Cr o Fe) sobre un sustrato de Mg (001)</li>
            <li>La difusión superficial de átomos depositados</li>
            <li>Tres modos de deposición: Térmico, Balístico y Aleatorio</li>
        </ul>
        <p><strong>Parámetros clave:</strong></p>
        <ul>
            <li>Rejilla tridimensional: 50×50×30 sitios</li>
            <li>Temperatura del sustrato: 500K</li>
            <li>Temperatura del plasma: 1000K</li>
            <li>Constante de Boltzmann: 8.617×10⁻⁵ eV/K</li>
        </ul>
        <p><strong>Propiedades de materiales:</strong></p>
        <ul>
            <li><strong>Cromo (Cr):</strong> Mayor adhesión (0.98), menor energía de difusión (0.01-0.25 eV)</li>
            <li><strong>Hierro (Fe):</strong> Menor adhesión (0.95), mayor energía de difusión (0.5-1.0 eV)</li>
        </ul>
    </div>
    
    <h2>Análisis del Modo Térmico</h2>
    <h3>Resultados Numéricos</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        <div class="result-card" style="flex: 1; min-width: 300px;">
            <h3>Resultados para Fe</h3>
            <ul>
                <li>Rugosidad: 6.83 ± 2.54 capas</li>
                <li>Espesor: 9.32 ± 5.29 capas</li>
                <li>Altura máxima: 24.45 ± 6.69 capas</li>
                <li>Cobertura (>10 capas): 40.96%</li>
                <li>Cobertura (>20 capas): 15.40%</li>
                <li>Distribución de etapas: 33.33% coalescencia, 66.67% crecimiento</li>
            </ul>
        </div>
        <div class="result-card" style="flex: 1; min-width: 300px;">
            <h3>Resultados para Cr</h3>
            <ul>
                <li>Rugosidad: 6.83 ± 2.56 capas</li>
                <li>Espesor: 9.22 ± 5.25 capas</li>
                <li>Altura máxima: 24.52 ± 6.83 capas</li>
                <li>Cobertura (>10 capas): 40.28%</li>
                <li>Cobertura (>20 capas): 15.13%</li>
                <li>Distribución de etapas: 33.33% coalescencia, 66.67% crecimiento</li>
            </ul>
        </div>
    </div>
    
    <h3>Conclusiones del Modo Térmico</h3>
    <ul>
        <li>Homogeneidad entre materiales: Las altas temperaturas (500K) igualan las diferencias intrínsecas entre Fe y Cr</li>
        <li>Crecimiento limitado: Ningún material supera 30 capas de altura, indicando saturación</li>
        <li>Etapa avanzada: Ausencia de nucleación (0%) y predominio de crecimiento (66.67%) sugieren películas maduras</li>
        <li>Cr forma islas más compactas inicialmente, pero ambos materiales convergen en espesor final</li>
    </ul>
    
    <h3>Visualización de Resultados</h3>
    ${imageData.map(img => `
    <div class="image-container">
        <img src="${img.src}" alt="${img.caption}" style="max-width: 600px;">
        <p class="image-caption"><strong>${img.caption}</strong></p>
        <p class="image-caption">${img.description}</p>
    </div>
    `).join('')}
    
    <h2>Análisis del Modo Balístico</h2>
    <h3>Resultados Numéricos</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        <div class="result-card" style="flex: 1; min-width: 300px;">
            <h3>Resultados para Fe</h3>
            <ul>
                <li>Rugosidad: 7.28 ± 2.62 capas</li>
                <li>Espesor: 10.52 ± 5.63 capas</li>
                <li>Altura máxima: 27.83 ± 7.01 capas</li>
                <li>Cobertura (>10 capas): 46.35%</li>
                <li>Cobertura (>20 capas): 20.83%</li>
                <li>Cobertura (>30 capas): 2.50%</li>
                <li>Distribución de etapas: 30.00% coalescencia, 70.00% crecimiento</li>
            </ul>
        </div>
        <div class="result-card" style="flex: 1; min-width: 300px;">
            <h3>Resultados para Cr</h3>
            <ul>
                <li>Rugosidad: 7.53 ± 2.68 capas</li>
                <li>Espesor: 10.81 ± 5.71 capas</li>
                <li>Altura máxima: 28.22 ± 7.12 capas</li>
                <li>Cobertura (>10 capas): 47.92%</li>
                <li>Cobertura (>20 capas): 21.67%</li>
                <li>Cobertura (>30 capas): 3.33%</li>
                <li>Distribución de etapas: 30.00% coalescencia, 70.00% crecimiento</li>
            </ul>
        </div>
    </div>
    
    <h3>Conclusiones del Modo Balístico</h3>
    <ul>
        <li><strong>Mayor crecimiento vertical:</strong> Ambos materiales alcanzan alturas superiores a 30 capas (imposible en modo térmico), confirmado por histograma con cola extendida y mapas 3D.</li>
        <li><strong>Mayor cobertura:</strong> Incremento significativo en áreas con >10 y >20 capas, especialmente en Cr (+43.2% vs +35.3% Fe), visible en mapas de contorno.</li>
        <li><strong>Mayor rugosidad:</strong> Cr muestra mayor incremento relativo (+10.3% vs +6.6% Fe), evidenciado por picos más pronunciados en mapas 3D y distribución de rugosidad más amplia.</li>
        <li><strong>Formación de nanoestructuras:</strong> Mapas de contorno revelan islas bien definidas con bordes nítidos, característicos del crecimiento balístico.</li>
        <li><strong>Respuesta material diferencial:</strong> Cr aprovecha mejor el modo balístico para alcanzar mayores espesores y coberturas, debido a su menor energía de difusión intrínseca.</li>
    </ul>
    
    <h2>Comparación entre Modos de Deposición</h2>
    <table>
        <tr>
            <th>Parámetro</th>
            <th>Modo Térmico</th>
            <th>Modo Balístico</th>
            <th>Cambio (%)</th>
        </tr>
        <tr>
            <td><strong>Fe - Rugosidad</strong></td>
            <td>6.83 ± 2.54</td>
            <td class="highlight">7.28 ± 2.62</td>
            <td><span class="badge badge-increase">+6.6%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Rugosidad</strong></td>
            <td>6.83 ± 2.56</td>
            <td class="highlight">7.53 ± 2.68</td>
            <td><span class="badge badge-increase">+10.3%</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Espesor</strong></td>
            <td>9.32 ± 5.29</td>
            <td class="highlight">10.52 ± 5.63</td>
            <td><span class="badge badge-increase">+12.9%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Espesor</strong></td>
            <td>9.22 ± 5.25</td>
            <td class="highlight">10.81 ± 5.71</td>
            <td><span class="badge badge-increase">+17.3%</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Altura Máxima</strong></td>
            <td>24.45 ± 6.69</td>
            <td class="highlight">27.83 ± 7.01</td>
            <td><span class="badge badge-increase">+13.8%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Altura Máxima</strong></td>
            <td>24.52 ± 6.83</td>
            <td class="highlight">28.22 ± 7.12</td>
            <td><span class="badge badge-increase">+15.0%</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Cobertura (>10 capas)</strong></td>
            <td>40.96%</td>
            <td class="highlight">46.35%</td>
            <td><span class="badge badge-increase">+13.2%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Cobertura (>10 capas)</strong></td>
            <td>40.28%</td>
            <td class="highlight">47.92%</td>
            <td><span class="badge badge-increase">+19.0%</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Cobertura (>20 capas)</strong></td>
            <td>15.40%</td>
            <td class="highlight">20.83%</td>
            <td><span class="badge badge-increase">+35.3%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Cobertura (>20 capas)</strong></td>
            <td>15.13%</td>
            <td class="highlight">21.67%</td>
            <td><span class="badge badge-increase">+43.2%</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Cobertura (>30 capas)</strong></td>
            <td>0.00%</td>
            <td class="highlight">2.50%</td>
            <td><span class="badge badge-increase">+∞</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Cobertura (>30 capas)</strong></td>
            <td>0.00%</td>
            <td class="highlight">3.33%</td>
            <td><span class="badge badge-increase">+∞</span></td>
        </tr>
        <tr>
            <td><strong>Fe - Etapa Crecimiento</strong></td>
            <td>66.67%</td>
            <td class="highlight">70.00%</td>
            <td><span class="badge badge-increase">+3.33%</span></td>
        </tr>
        <tr>
            <td><strong>Cr - Etapa Crecimiento</strong></td>
            <td>66.67%</td>
            <td class="highlight">70.00%</td>
            <td><span class="badge badge-increase">+3.33%</span></td>
        </tr>
    </table>
    
    <h3>Interpretación Física</h3>
    <ul>
        <li><strong>Energía cinética más alta:</strong> El modo balístico (5.0 eV vs. 2.0 eV térmico) permite a los átomos penetrar más profundamente en la superficie</li>
        <li><strong>Menor movilidad superficial:</strong> Menor tiempo para difusión antes de quedar "atrapados", favoreciendo el crecimiento vertical</li>
        <li><strong>Menor tasa de deposición:</strong> 20,000 (vs. 50,000 térmico) permite a los átomos apilarse más verticalmente</li>
        <li><strong>Respuesta diferencial de materiales:</strong> Cr muestra mayores incrementos que Fe debido a su menor energía de difusión intrínseca</li>
    </ul>
    
    <h2>Conclusiones Finales</h2>
    <h3>Relación con Objetivos del Trabajo</h3>
    <table>
        <tr>
            <th>Objetivo Específico</th>
            <th>Evidencia</th>
            <th>Cumplimiento</th>
        </tr>
        <tr>
            <td>Caracterizar mecanismos de deposición</td>
            <td>Mayor crecimiento vertical en balístico (70% vs. 66.67% térmico)</td>
            <td><span class="badge badge-success">Completado</span></td>
        </tr>
        <tr>
            <td>Efectos de difusión superficial</td>
            <td>Mayor rugosidad en Cr (+10.3% vs. +6.6% Fe) confirma menor movilidad</td>
            <td><span class="badge badge-success">Completado</span></td>
        </tr>
        <tr>
            <td>Efecto del modo de deposición</td>
            <td>Diferencias significativas: +12-17% espesor, +6-10% rugosidad</td>
            <td><span class="badge badge-success">Completado</span></td>
        </tr>
    </table>
    
    <h3>Conclusiones Principales</h3>
    <ul>
        <li><strong>Modo Térmico:</strong> Produce películas más uniformes y continuas, con menor rugosidad y crecimiento vertical limitado. Ideal para aplicaciones que requieren homogeneidad superficial.</li>
        <li><strong>Modo Balístico:</strong> Genera películas más gruesas con mayor cobertura, pero con mayor rugosidad. Permite alcanzar alturas >30 capas, imposible en modo térmico. Adecuado para aplicaciones que requieren mayor espesor.</li>
        <li><strong>Diferencias materiales:</strong> Cr responde más intensamente al cambio de modo que Fe, debido a su menor energía de difusión intrínseca.</li>
        <li><strong>Implicaciones prácticas:</strong> 
            <ul>
                <li>Para aplicaciones que requieren continuidad: Fe en modo térmico es preferible</li>
                <li>Para aplicaciones que requieren nanoestructuras definidas: Cr en modo balístico es mejor</li>
                <li>Para mayor espesor: Modo balístico es superior</li>
            </ul>
        </li>
    </ul>
    
    <p style="text-align: center; margin-top: 30px; font-size: 10pt; color: #666;">
        Elaborado por Ángel Chacín Ávila @2025 se publica con licencia GPL
    </p>
</div>
</body>
</html>`;
                
                toggleLoading(true, 'Creando archivo Word...', 80);
                
                // Crear un blob con el contenido HTML
                const blob = new Blob([htmlContent], { 
                    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' 
                });
                
                toggleLoading(true, 'Finalizando descarga...', 95);
                
                // Crear un enlace de descarga
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'Simulacion_Monte_Carlo_Deposicion_Peliculas_Delgadas.doc';
                
                // Simular clic en el enlace
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Liberar el objeto URL
                URL.revokeObjectURL(link.href);
                
                toggleLoading(true, 'Documento descargado correctamente', 100);
                
                showStatus('Documento Word generado y descargado correctamente', 'success');
                
                // Restaurar el botón después de un breve retraso
                setTimeout(() => {
                    downloadBtn.disabled = false;
                    downloadBtn.innerHTML = originalText;
                    toggleLoading(false);
                }, 2000);
                
            } catch (error) {
                console.error('Error al generar el documento:', error);
                showStatus(`Error al generar el documento: ${error.message}`, 'error');
                
                // Restaurar el botón
                downloadBtn.disabled = false;
                downloadBtn.innerHTML = originalText;
                toggleLoading(false);
            }
        }
        
        // Event listener para el botón de descarga
        document.getElementById('download-btn').addEventListener('click', generateWordDocument);
    </script>
</body>
</html>
