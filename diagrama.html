<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama de Flujo KMC - Para Word</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: #333;
            text-align: center;
        }

        .controls {
            margin-bottom: 20px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Estilos especÃ­ficos para que se vea bien en pantalla Y en Word */
        #diagram-container {
            background-color: white;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table.flowchart {
            width: 100%;
            border-collapse: collapse;
            margin: 0 auto;
            max-width: 800px;
        }

        td {
            padding: 10px;
            vertical-align: middle;
            text-align: center;
            font-size: 14px;
        }

        /* Estilos de las formas (Nodos) */
        .node {
            border: 2px solid #000;
            border-radius: 5px;
            padding: 10px;
            font-weight: bold;
            color: #000;
        }

        .start-end {
            background-color: #d4edda; /* Verde claro */
            border-radius: 20px; /* Bordes redondeados */
            border-color: #28a745;
        }

        .process {
            background-color: #cce5ff; /* Azul claro */
            border-color: #007bff;
        }

        .decision {
            background-color: #fff3cd; /* Amarillo claro */
            border-color: #ffc107;
            /* Transformar a rombo es difÃ­cil de copiar a Word, usamos rectÃ¡ngulo con etiqueta */
        }

        .sub-process {
            background-color: #e2e3e5; /* Gris claro */
            font-style: italic;
            font-size: 12px;
        }

        .arrow {
            font-size: 24px;
            line-height: 0.5;
            color: #555;
        }

        .label-branch {
            font-size: 11px;
            color: #666;
            background: #fff;
            padding: 2px 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        /* Contenedores invisibles para estructurar el flujo */
        .spacer {
            border: none;
            background: none;
            height: 10px;
        }
        
        .loop-label {
            font-size: 12px;
            color: #d63384;
            font-weight: bold;
            border: 2px dashed #d63384;
            padding: 5px;
            border-radius: 5px;
            display: inline-block;
        }
    </style>
</head>
<body>

    <h1>Diagrama de Flujo: SimulaciÃ³n KMC (jupiter5.f90)</h1>

    <div class="controls">
        <button onclick="copiarDiagrama()">ðŸ“‹ Seleccionar y Copiar para Word</button>
        <p style="font-size: 12px; color: #666; margin-top: 10px;">
            Instrucciones: Haz clic en el botÃ³n, luego presiona Ctrl+V en tu documento de Word o Writer.
        </p>
    </div>

    <div id="diagram-container">
        <!-- El JavaScript inyectarÃ¡ la tabla aquÃ­ -->
    </div>

    <script>
        // FunciÃ³n para generar el HTML de la tabla del diagrama
        function generarHTMLDiagrama() {
            let html = `
            <table class="flowchart">
                <!-- INICIO -->
                <tr>
                    <td colspan="5" class="node start-end">INICIO</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                
                <!-- DECLARACIÃ“N -->
                <tr>
                    <td colspan="5" class="node process">Declarar Constantes y Variables</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- INPUT MATERIAL -->
                <tr>
                    <td colspan="5" class="node process">INPUT: SelecciÃ³n de Material (1=Cr, 2=Fe)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- DECISIÃ“N MATERIAL -->
                <tr>
                    <td colspan="5" class="node decision">Â¿CuÃ¡l Material?</td>
                </tr>
                <tr>
                    <td class="arrow" style="font-size:14px">SÃ­ (Cr)</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="arrow" style="font-size:14px">SÃ­ (Fe)</td>
                </tr>
                <tr>
                    <td class="node process" style="width: 20%">Configurar ParÃ¡metros Cr<br>(Adh=0.98, Ed Baja)</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="node process" style="width: 20%">Configurar ParÃ¡metros Fe<br>(Adh=0.95, Ed Alta)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“ (Unir flujo)</td>
                </tr>

                <!-- INPUTS GENERALES -->
                <tr>
                    <td colspan="5" class="node process">INPUT: Modo de DeposiciÃ³n (TÃ©rmico/BalÃ­stico)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node process">INPUT: NÂº de Corridas y Snapshots</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- BUCLE CORRIDAS -->
                <tr>
                    <td colspan="5" class="node decision"><span class="loop-label">INICIO BUCLE CORRIDAS</span></td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node sub-process">Inicializar Semilla Aleatoria y ParÃ¡metros (Tasa, EnergÃ­a)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node sub-process">Inicializar Rejilla (Sustrato Mg en capas 1 y 2)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- BUCLE EVENTOS -->
                <tr>
                    <td colspan="5" class="node decision"><span class="loop-label">INICIO BUCLE EVENTOS (Mientras eventos < MAX)</span></td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node sub-process">Avanzar Tiempo (KMC): t = t - ln(r) / R_total</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- DECISIÃ“N TIPO EVENTO -->
                <tr>
                    <td colspan="5" class="node decision">Seleccionar Tipo de Evento (Aleatorio Ponderado)</td>
                </tr>
                <tr>
                    <td class="label-branch">Tasa DeposiciÃ³n</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="label-branch">Tasa DifusiÃ³n</td>
                </tr>
                
                <!-- RAMAS: DEPÃ“SITO VS DIFUSIÃ“N -->
                <tr>
                    <td class="node process" rowspan="9" valign="top" style="vertical-align:top">
                        <strong>RUTA: DEPOSICIÃ“N</strong><br><br>
                        1. Elegir (x,y) al azar<br>
                        2. Buscar z_max vecinos<br>
                        3. Calcular Prob. AdhesiÃ³n<br>
                        4. Â¿Se adhiere?<br>
                        &nbsp;&nbsp;SÃ­: Colocar Ã¡tomo<br>
                        &nbsp;&nbsp;No: Fin evento
                    </td>
                    <td colspan="3"></td>
                    <td class="node process" rowspan="9" valign="top" style="vertical-align:top">
                        <strong>RUTA: DIFUSIÃ“N</strong><br><br>
                        1. Elegir Ã¡tomo (x,y)<br>
                        2. Â¿Es Ã¡tomo depositado?<br>
                        3. Â¿Prob. DifusiÃ³n > r?<br>
                        4. Elegir direcciÃ³n vecina<br>
                        5. Â¿Sitio vacÃ­o y vÃ¡lido?<br>
                        &nbsp;&nbsp;SÃ­: Mover Ã¡tomo
                    </td>
                </tr>
                <tr><td colspan="3"></td></tr> <!-- Espaciador -->
                <tr><td colspan="3"></td></tr>
                <tr><td colspan="3"></td></tr>
                <tr><td colspan="3"></td></tr>
                <tr><td colspan="3"></td></tr>
                
                <!-- MERGE -->
                <tr>
                    <td colspan="5" class="arrow">â†“ (Unir flujo)</td>
                </tr>

                <!-- SNAPSHOT CHECK -->
                <tr>
                    <td colspan="5" class="node decision">Â¿Evento mÃºltiplo de 1000?</td>
                </tr>
                <tr>
                    <td class="label-branch">SÃ­</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="label-branch">No</td>
                </tr>
                <tr>
                    <td class="node process">Calcular MÃ©tricas (Rugosidad, Islas)</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="node sub-process">Continuar Bucle</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node process">Guardar Datos en Archivo .dat</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- FIN BUCLE EVENTOS -->
                <tr>
                    <td colspan="5" class="node decision">Â¿Eventos >= MAX_EVENTOS?</td>
                </tr>
                <tr>
                    <td colspan="5" class="label-branch">No (Volver arriba)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node process"><span class="loop-label">FIN BUCLE EVENTOS</span></td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node process">Guardar Snapshot Final</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- FIN BUCLE CORRIDAS -->
                <tr>
                    <td colspan="5" class="node decision">Â¿MÃ¡s corridas pendientes?</td>
                </tr>
                <tr>
                    <td colspan="5" class="label-branch">SÃ­ (Volver a Inicio Bucle Corridas)</td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>
                <tr>
                    <td colspan="5" class="node process"><span class="loop-label">FIN BUCLE CORRIDAS</span></td>
                </tr>
                <tr>
                    <td colspan="5" class="arrow">â†“</td>
                </tr>

                <!-- FIN -->
                <tr>
                    <td colspan="5" class="node start-end">FIN DEL PROGRAMA</td>
                </tr>
            </table>
            `;
            return html;
        }

        // Renderizar el diagrama al cargar
        document.getElementById('diagram-container').innerHTML = generarHTMLDiagrama();

        // FunciÃ³n para copiar al portapapeles
        function copiarDiagrama() {
            const container = document.getElementById('diagram-container');
            
            // Crear un rango de selecciÃ³n
            const range = document.createRange();
            range.selectNode(container);
            
            // Seleccionar el contenido
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            
            try {
                // Ejecutar comando de copia
                const successful = document.execCommand('copy');
                if (successful) {
                    alert('Â¡Diagrama copiado! Ahora ve a Word y presiona Ctrl+V.');
                } else {
                    alert('No se pudo copiar automÃ¡ticamente. Por favor selecciona el diagrama manualmente y copia (Ctrl+C).');
                }
            } catch (err) {
                alert('Error al copiar: ' + err);
            }
            
            // Limpiar selecciÃ³n
            selection.removeAllRanges();
        }
    </script>
</body>
</html>
