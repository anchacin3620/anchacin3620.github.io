<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Despeje de Ecuaciones de Primer Grado</title>
    <!-- Carga de Tailwind CSS para un dise√±o limpio y responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7; /* Fondo claro */
        }

        .screen-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            padding: 1rem;
        }

        /* Estilos para el texto de la ecuaci√≥n (fuente monoespaciada para claridad matem√°tica) */
        .equation-display {
            font-family: 'Roboto Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937; /* Gris oscuro */
            margin-bottom: 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            min-height: 3rem; /* Evita CLS al cambiar de contenido */
        }

        /* Destacado (highlight) para los elementos activos de la ecuaci√≥n */
        .highlight {
            transition: color 0.5s ease-in-out, background-color 0.5s ease-in-out, transform 0.3s;
            color: #ef4444; /* Rojo para la acci√≥n */
            padding: 2px 4px;
            border-radius: 4px;
            display: inline-block;
        }

        /* Estilos para el √≠cono central */
        .animation-icon {
            font-size: 4rem; 
            position: relative;
            opacity: 0;
            transition: opacity 0.5s;
            margin-bottom: 1rem;
        }

        /* Estilos para el texto explicativo */
        .text-overlay {
            color: #374151; 
            font-size: 1.25rem;
            text-align: center;
            opacity: 0;
            transition: opacity 1s;
            max-width: 90%;
            padding: 0.75rem;
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Media query para escritorio */
        @media (min-width: 640px) {
            .equation-display {
                font-size: 3rem;
            }
            .text-overlay {
                font-size: 1.5rem;
                max-width: 60%;
            }
            .animation-icon {
                font-size: 6rem;
            }
        }
    </style>
</head>
<body>

    <div id="video-simulation" class="screen-container">
        
        <!-- √çcono central de la animaci√≥n -->
        <div id="icon" class="animation-icon"></div>

        <!-- √Årea de visualizaci√≥n de la ecuaci√≥n -->
        <div id="equation" class="equation-display"></div>

        <!-- Texto explicativo -->
        <div id="text" class="text-overlay"></div>

        <!-- Barra de Progreso en la parte inferior -->
        <div class="absolute bottom-6 w-11/12 max-w-lg h-2 bg-gray-300 rounded-full overflow-hidden shadow-inner">
            <div id="progress-bar" class="h-full bg-red-500 rounded-full transition-all duration-100 ease-linear" style="width: 0%;"></div>
        </div>
    </div>

    <script>
        // --- Definici√≥n de las etapas del tutorial ---
        const tutorialStages = [
            { duration: 4000, text: "Ecuaci√≥n inicial: Nuestro objetivo es aislar la inc√≥gnita 'x'.", equation: "x + 4 = 8", focus: ['x'], icon: "üîé" },
            { duration: 3500, text: "Para aislar 'x', debemos eliminar el '+4'. Usaremos la operaci√≥n inversa (resta).", equation: "x + 4 = 8", focus: ['4'], icon: "‚ûñ" },
            { duration: 4000, text: "Aplicamos la resta (-4) a AMBOS lados para mantener la igualdad.", equation: "x + 4 - 4 = 8 - 4", focus: ['- 4', '- 4'], icon: "‚öñÔ∏è" },
            { duration: 3000, text: "Simplificamos. En la izquierda, $4 - 4 = 0$, ¬°y 'x' queda sola!", equation: "x = 8 - 4", focus: ['8 - 4'], icon: "‚û°Ô∏è" },
            { duration: 3500, text: "Resolvemos la operaci√≥n final a la derecha: $8 - 4 = 4$.", equation: "x = 4", focus: ['4'], icon: "‚úÖ" },
            { duration: 4000, text: "¬°Soluci√≥n encontrada! Si reemplazamos en la original ($4+4=8$), es correcta.", equation: "4 + 4 = 8", focus: ['4'], icon: "üåü" }
        ];

        const textElement = document.getElementById('text');
        const iconElement = document.getElementById('icon');
        const equationElement = document.getElementById('equation');
        const progressBar = document.getElementById('progress-bar');
        
        const totalDuration = tutorialStages.reduce((sum, stage) => sum + stage.duration, 0);
        
        let startTime = null;
        let currentStageIndex = 0;
        let elapsedTotalTime = 0;

        // Funci√≥n para renderizar el HTML de la ecuaci√≥n con el enfoque/highlighting
        const renderEquationHTML = (equationString, focusTerms) => {
            let html = equationString;
            
            // Reemplaza los t√©rminos enfocados con la clase 'highlight'
            focusTerms.forEach(term => {
                // Usamos una expresi√≥n regular para asegurar que solo se reemplace el t√©rmino completo
                const escapedTerm = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(`(${escapedTerm})`, 'g');
                html = html.replace(regex, `<span class="highlight">${term}</span>`);
            });

            return `<span class="px-2 py-1">${html}</span>`;
        };

        // Funci√≥n para actualizar los elementos visuales en cada etapa
        const updateStage = (stage) => {
            // 1. Ocultar elementos para la transici√≥n
            textElement.style.opacity = '0';
            iconElement.style.opacity = '0';
            equationElement.style.transform = 'scale(0.95)';
            equationElement.style.opacity = '0';


            setTimeout(() => {
                // 2. Actualizar contenido
                equationElement.innerHTML = renderEquationHTML(stage.equation, stage.focus);
                textElement.textContent = stage.text;
                iconElement.textContent = stage.icon;
                
                // 3. Mostrar contenido con transici√≥n
                textElement.style.opacity = '1';
                iconElement.style.opacity = '1';
                equationElement.style.transform = 'scale(1)';
                equationElement.style.opacity = '1';

            }, 500); // Peque√±a pausa para el efecto de transici√≥n
        };

        // Bucle principal de animaci√≥n
        const animate = (timestamp) => {
            if (!startTime) startTime = timestamp;
            const deltaTime = timestamp - startTime;

            if (currentStageIndex < tutorialStages.length) {
                const currentStage = tutorialStages[currentStageIndex];

                // Verificar avance de etapa
                if (deltaTime >= currentStage.duration) {
                    elapsedTotalTime += currentStage.duration;
                    startTime = timestamp; 
                    currentStageIndex++;

                    if (currentStageIndex < tutorialStages.length) {
                        updateStage(tutorialStages[currentStageIndex]);
                    } else {
                        // Fin de la simulaci√≥n
                        textElement.textContent = "¬°Tutorial completado! ¬øQuieres ver otro ejemplo (e.g., $2x - 5 = 11$)?";
                        iconElement.style.opacity = '0';
                        progressBar.style.width = '100%';
                        return; 
                    }
                }
                
                // Actualizar barra de progreso
                let currentStageElapsed = timestamp - startTime;
                let totalProgressTime = elapsedTotalTime + currentStageElapsed;
                let progressWidth = Math.min(100, (totalProgressTime / totalDuration) * 100);
                progressBar.style.width = `${progressWidth}%`;

            }
            
            requestAnimationFrame(animate);
        };

        // Iniciar la simulaci√≥n al cargar la p√°gina
        window.onload = function() {
            if (tutorialStages.length > 0) {
                updateStage(tutorialStages[0]);
                requestAnimationFrame(animate);
            }
        };

    </script>
</body>
</html>

